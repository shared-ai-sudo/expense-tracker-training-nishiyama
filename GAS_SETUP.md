# Google Apps Script セットアップ手順

このアプリの支出データを「シン新人研修4.gsheet」に同期するための設定方法です。

## 1. Google Apps Script エディタを開く

1. Googleスプレッドシート「シン新人研修4.gsheet」を開く
2. メニューから **拡張機能 > Apps Script** を選択

## 2. コードを貼り付け

1. Apps Scriptエディタが開いたら、既存の`Code.gs`ファイルの内容を削除
2. `Code.gs`ファイルに以下のコードを貼り付け:
   - このフォルダ内の`Code.gs`ファイルの内容をコピー
   - Apps Scriptエディタに貼り付け
3. **保存**ボタンをクリック（Ctrl+S または Cmd+S）

## 3. Webアプリとしてデプロイ

1. Apps Scriptエディタの右上にある **デプロイ > 新しいデプロイ** をクリック
2. **種類の選択** で **ウェブアプリ** を選択
3. 以下の設定を行う:
   - **説明**: 「支出記録アプリ同期」など任意の名前
   - **次のユーザーとして実行**: **自分**
   - **アクセスできるユーザー**: **全員**
4. **デプロイ** ボタンをクリック
5. 初回は承認が必要です:
   - **アクセスを承認** をクリック
   - Googleアカウントを選択
   - 「このアプリは確認されていません」と表示された場合:
     - **詳細** をクリック
     - **（安全ではないページ）に移動** をクリック
     - **許可** をクリック
6. デプロイが完了すると、**ウェブアプリのURL**とスクリプトIDが表示されます

## 4. スクリプトIDを確認

デプロイ完了画面で表示される **デプロイID（スクリプトID）** をコピーします。

現在設定されているスクリプトID:
```
1oAbPzE9Nb_nPEVhoBNkG90QohTGovhqo52IoUd7miv31RqETANsSy2J2
```

このIDが`main.js`の9行目に正しく設定されていることを確認してください。

## 5. 動作確認

1. HTMLアプリを開く（`index.html`をブラウザで開く）
2. 支出を追加してみる
3. Googleスプレッドシート「シン新人研修4.gsheet」を開く
4. 「支出データ」というシートが自動作成され、データが同期されていることを確認

## トラブルシューティング

### 同期が失敗する場合

1. **スクリプトIDが正しいか確認**
   - `main.js`の9行目のIDが正しいか確認

2. **デプロイの設定を確認**
   - Apps Scriptエディタで **デプロイ > デプロイを管理** を開く
   - 「アクセスできるユーザー」が **全員** になっているか確認

3. **ブラウザのコンソールでエラーを確認**
   - ブラウザの開発者ツール（F12）を開く
   - Consoleタブでエラーメッセージを確認

4. **GASのログを確認**
   - Apps Scriptエディタで **実行 > ログを表示** を開く
   - エラーメッセージがないか確認

### テスト用関数

Apps Scriptエディタで以下を実行してテストできます:

1. 関数選択ドロップダウンから `testSync` を選択
2. **実行** ボタンをクリック
3. スプレッドシートに「支出データ」シートが作成され、サンプルデータが追加されることを確認

## 仕様

- 同期は**追加・削除時に自動実行**されます
- スプレッドシートの既存データは**上書き**されます（アプリのlocalStorageが正とされます）
- データは日付の降順でソートされます
- 以下の項目が同期されます:
  - ID
  - 日付
  - カテゴリ
  - 金額
  - メモ
  - 作成日時
