# 支出記録アプリ（Expense Tracker）仕様書

## 概要

支出記録アプリは、ユーザーが日々の支出を記録・管理し、支出傾向を可視化するためのWebアプリケーションです。シンプルで直感的なUIにより、誰でも簡単に支出を追跡できます。

## 目的

- 個人の支出を簡単に記録・管理する
- カテゴリ別に支出を分類し、支出傾向を把握する
- 月次・週次の支出統計を可視化する
- データをローカルに保存し、プライバシーを保護する

## 画面構成

### 1. メイン画面（ダッシュボード）

- **ヘッダー**
  - アプリタイトル
  - 現在の月と年の表示
  - 月次合計金額の表示

- **支出入力フォーム**
  - 日付選択（デフォルト：今日）
  - 金額入力フィールド
  - カテゴリ選択ドロップダウン
  - メモ入力フィールド（任意）
  - 追加ボタン

- **支出一覧セクション**
  - 登録済み支出のリスト表示
  - 各項目：日付、カテゴリ、金額、メモ、削除ボタン
  - 日付の新しい順に表示
  - フィルター機能（全て/今週/今月）

- **統計セクション**
  - カテゴリ別支出グラフ（円グラフまたは棒グラフ）
  - 月次推移グラフ
  - カテゴリ別合計金額一覧

### 2. レイアウト

- レスポンシブデザイン（モバイル・タブレット・PC対応）
- シングルページアプリケーション（SPA）形式

## 入出力仕様

### 入力

| 項目 | 型 | 必須 | 制約 | 説明 |
|------|------|------|------|------|
| 日付 | Date | ○ | 未来日不可 | 支出が発生した日付 |
| 金額 | Number | ○ | 正の整数、1円以上 | 支出金額（円） |
| カテゴリ | String | ○ | 選択式 | 支出のカテゴリ |
| メモ | String | × | 最大100文字 | 支出の詳細説明 |

### 出力

- **支出一覧表示**
  - 日付、カテゴリ、金額、メモを表形式で表示
  - 合計金額の表示

- **統計データ**
  - カテゴリ別支出割合（％）
  - カテゴリ別支出合計額
  - 期間別支出合計額

### カテゴリ一覧

- 食費
- 交通費
- 娯楽
- 光熱費
- 通信費
- 医療費
- 衣服
- 教育
- その他

## 機能一覧

### 1. 支出登録機能

- **機能ID**: F001
- **概要**: 新しい支出を記録する
- **処理フロー**:
  1. ユーザーが入力フォームに情報を入力
  2. 入力値をバリデーション
  3. localStorageにデータを保存
  4. 支出一覧を更新
  5. 統計データを再計算
  6. フォームをクリア

### 2. 支出一覧表示機能

- **機能ID**: F002
- **概要**: 登録済みの支出を一覧表示する
- **処理フロー**:
  1. localStorageからデータを取得
  2. 日付でソート（降順）
  3. 一覧形式で表示

### 3. 支出削除機能

- **機能ID**: F003
- **概要**: 登録済みの支出を削除する
- **処理フロー**:
  1. ユーザーが削除ボタンをクリック
  2. 確認ダイアログを表示
  3. 確認後、localStorageから該当データを削除
  4. 支出一覧を更新
  5. 統計データを再計算

### 4. フィルター機能

- **機能ID**: F004
- **概要**: 期間やカテゴリで支出を絞り込む
- **処理フロー**:
  1. ユーザーがフィルター条件を選択
  2. 条件に合致する支出のみを表示
  3. フィルター後の合計金額を表示

### 5. 統計表示機能

- **機能ID**: F005
- **概要**: 支出データを統計グラフで可視化する
- **処理フロー**:
  1. localStorageからデータを取得
  2. カテゴリ別・期間別に集計
  3. グラフライブラリを使用して可視化
  4. 統計サマリーを表示

### 6. データエクスポート機能（オプション）

- **機能ID**: F006
- **概要**: 支出データをCSV形式でダウンロード
- **処理フロー**:
  1. localStorageからデータを取得
  2. CSV形式に変換
  3. ダウンロードリンクを生成

### 7. データインポート機能（オプション）

- **機能ID**: F007
- **概要**: CSV形式のデータをインポート
- **処理フロー**:
  1. ファイル選択
  2. CSVパース
  3. データバリデーション
  4. localStorageに保存

## 使用技術

### HTML5

- **バージョン**: HTML5
- **用途**: アプリケーションの構造とマークアップ
- **主要要素**:
  - セマンティックタグ（`<header>`, `<main>`, `<section>`, `<footer>`）
  - フォーム要素（`<input>`, `<select>`, `<button>`）
  - `<canvas>`（グラフ描画用、Chart.js使用時）

### CSS3

- **バージョン**: CSS3
- **用途**: スタイリングとレイアウト
- **主要機能**:
  - Flexbox / Grid レイアウト
  - メディアクエリ（レスポンシブデザイン）
  - CSS変数（テーマカラー管理）
  - トランジション・アニメーション
- **CSSフレームワーク（オプション）**:
  - 独自CSS、または軽量フレームワーク（Pico.css、Bootstrap等）

### JavaScript（ES6+）

- **バージョン**: ES6以降（ES2015+）
- **用途**: アプリケーションロジックとインタラクション
- **主要機能**:
  - DOM操作
  - イベントハンドリング
  - localStorage API
  - Date オブジェクト操作
  - データのバリデーション
  - 配列・オブジェクト操作（map, filter, reduce等）
- **外部ライブラリ（オプション）**:
  - **Chart.js**: グラフ描画
  - **Day.js**: 日付操作（軽量な代替として）

## データ構造

### localStorageキー構成

```javascript
{
  "expenses": [] // 支出データの配列
}
```

### 支出データオブジェクト（Expense Object）

```javascript
{
  "id": "string",           // 一意識別子（UUID or タイムスタンプ）
  "date": "YYYY-MM-DD",     // 支出日付（ISO 8601形式）
  "amount": number,         // 支出金額（円、正の整数）
  "category": "string",     // カテゴリ名
  "memo": "string",         // メモ（任意）
  "createdAt": "timestamp"  // 登録日時（タイムスタンプ）
}
```

### データ例

```javascript
{
  "expenses": [
    {
      "id": "1697012345678",
      "date": "2025-10-14",
      "amount": 1200,
      "category": "食費",
      "memo": "ランチ",
      "createdAt": 1697012345678
    },
    {
      "id": "1697023456789",
      "date": "2025-10-14",
      "amount": 300,
      "category": "交通費",
      "memo": "電車代",
      "createdAt": 1697023456789
    },
    {
      "id": "1697034567890",
      "date": "2025-10-13",
      "amount": 5000,
      "category": "娯楽",
      "memo": "映画チケット",
      "createdAt": 1697034567890
    }
  ]
}
```

### localStorage操作関数

```javascript
// データ取得
function getExpenses() {
  const data = localStorage.getItem('expenses');
  return data ? JSON.parse(data) : [];
}

// データ保存
function saveExpenses(expenses) {

  localStorage.setItem('expenses', JSON.stringify(expenses));
}

// 支出追加
function addExpense(expense) {
  const expenses = getExpenses();
  expenses.push(expense);
  saveExpenses(expenses);
}

// 支出削除
function deleteExpense(id) {
  const expenses = getExpenses();
  const filtered = expenses.filter(expense => expense.id !== id);
  saveExpenses(filtered);
}
```

## バリデーションルール

### 入力値検証

1. **日付**
   - 必須項目
   - 有効な日付形式
   - 未来日不可

2. **金額**
   - 必須項目
   - 数値型
   - 正の整数
   - 1円以上
   - 最大値：9,999,999円

3. **カテゴリ**
   - 必須項目
   - 定義済みカテゴリから選択

4. **メモ**
   - 任意項目
   - 最大100文字

## エラーハンドリング

- 入力エラー: フォーム下部にエラーメッセージ表示
- localStorage容量オーバー: アラート表示とデータエクスポート推奨
- データ読み込みエラー: 初期化処理とエラーログ

## パフォーマンス考慮事項

- データ量が増加した場合の対応
  - ページネーション実装
  - 仮想スクロール（大量データ時）
  - 古いデータのアーカイブ機能

- グラフ描画の最適化
  - データ集計のキャッシュ
  - 必要時のみ再描画

## セキュリティ・プライバシー

- データはすべてローカル（localStorage）に保存
- サーバーへのデータ送信なし
- XSS対策: ユーザー入力のサニタイズ
- ブラウザのlocalStorageクリア時のデータ消失に注意

## ブラウザ対応

- Chrome（最新版）
- Firefox（最新版）
- Safari（最新版）
- Edge（最新版）
- モバイルブラウザ対応

## 今後の拡張機能（検討事項）

- 予算設定機能
- 収入記録機能
- 複数通貨対応
- データのクラウド同期
- 定期支出の自動登録
- レシート撮影・OCR機能
- 通知機能（予算超過アラート等）

---

**作成日**: 2025-10-14
**バージョン**: 1.0

